{% extends "_layouts/cp" %}


{% set tests = {
    'criticalCraftUpdates': {
        'name': 'Critical Craft Updates',
        'type': 'upload',
        'typeName': 'Software Update',
        'details': {
            'pass': 'No critical Craft updates available',
            'warning': 'Apply critical Craft updates:',
        },
        'info': 'Critical Craft updates should be given immediate attention as soon as they are released as they can contain important security fixes.',
        'url': 'https://github.com/craftcms/cms/blob/master/CHANGELOG.md',
    },
    'criticalPluginUpdates': {
        'name': 'Critical Plugin Updates',
        'type': 'plugin',
        'typeName': 'Plugins',
        'details': {
            'pass': 'No critical plugin updates available',
            'warning': 'Apply critical plugin updates:',
        },
        'info': 'Critical plugin updates should be given immediate attention as soon as they are released as they can contain important security fixes.',
    },
    'httpsControlPanel': {
        'name': 'HTTPS In Control Panel',
        'type': 'secure',
        'typeName': 'Security',
        'details': {
            'pass': 'Control panel is forcing an encrypted HTTPS connection',
            'warning': 'Force an encrypted HTTPS connection in control panel',
        },
        'info': 'Using an SSL certificate and forcing the control panel to use an encrypted HTTPS connection ensures secure authentication of users and protects site data.',
        'url': 'https://craftcms.com/knowledge-base/enforcing-ssl-for-cp-requests',
    },
    'httpsFrontEnd': {
        'name': 'HTTPS On Front-End',
        'type': 'secure',
        'typeName': 'Security',
        'details': {
            'pass': 'Front-end site is forcing an encrypted HTTPS connection',
            'warning': 'Force an encrypted HTTPS connection on front-end',
        },
        'info': 'Using an SSL certificate and forcing the front-end of your site to use an encrypted HTTPS connection protects the site and user data. This is especially important if public user registration is allowed.',
        'url': 'https://craftcms.com/knowledge-base/securing-craft#install-an-ssl-certificate-and-enforce-it',
    },
    'contentSecurityPolicy': {
        'name': 'Content-Security-Policy Header',
        'type': 'secure',
        'typeName': 'HTTP Header',
        'details': {
            'pass': '',
            'warning': '',
        },
        'info': 'The HTTP Content-Security-Policy response header allows web site administrators to control resources the user agent is allowed to load for a given page. With a few exceptions, policies mostly involve specifying server origins and script endpoints. This helps guard against cross-site scripting attacks (XSS).',
        'url': 'https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy',
    },
    'cors': {
        'name': 'Cross-Origin Resource Sharing (CORS)',
        'type': 'secure',
        'typeName': 'HTTP Header',
        'details': {
            'pass': 'Access to other sites is not granted',
            'warning': 'Access is granted to:',
            'fail': 'Remove CORS access:',
        },
        'info': 'Cross-Origin Resource Sharing (CORS) is an HTTP-header based mechanism that allows a server to indicate any other origins (domain, scheme, or port) than its own from which a browser should permit loading of resources. CORS also relies on a mechanism by which browsers make a “preflight” request to the server hosting the cross-origin resource, in order to check that the server will permit the actual request. In that preflight, the browser sends headers that indicate the HTTP method and headers that will be used in the actual request.',
        'url': 'https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS',
    },
    'expectCT': {
        'name': 'Expect-CT Header',
        'type': 'secure',
        'typeName': 'HTTP Header',
        'details': {
            'pass': 'Expect-CT header is set to',
            'warning': 'Set the Expect-CT header',
        },
        'info': 'The Expect-CT header lets sites opt in to reporting and/or enforcement of Certificate Transparency requirements, to prevent the use of misissued certificates for that site from going unnoticed.',
        'url': 'https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Expect-CT',
    },
    'referrerPolicy': {
        'name': 'Referrer-Policy Header',
        'type': 'secure',
        'typeName': 'HTTP Header',
        'details': {
            'pass': 'Referrer-Policy header is set to',
            'warning': 'Set the Referrer-Policy header',
        },
        'info': 'The Referrer-Policy header controls how much referrer information (sent via the Referer header) should be included with requests.',
        'url': 'https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy',
    },
    'strictTransportSecurity': {
        'name': 'Strict-Transport-Security Header',
        'type': 'secure',
        'typeName': 'HTTP Header',
        'details': {
            'pass': 'Strict-Transport-Security header is set to',
            'warning': 'Set Strict-Transport-Security header to "max-age=31536000"',
        },
        'info': 'The Strict-Transport-Security header (often abbreviated as HSTS) lets a web site tell browsers that it should only be accessed using HTTPS, instead of using HTTP.',
        'url': 'https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security',
    },
    'xContentTypeOptions': {
        'name': 'X-Content-Type-Options Header',
        'type': 'secure',
        'typeName': 'HTTP Header',
        'details': {
            'pass': 'X-Content-Type-Options header is set to',
            'warning': 'Set X-Content-Type-Options header to "nosniff"',
        },
        'info': 'The X-Content-Type-Options header is a marker used by the server to indicate that the MIME types advertised in the Content-Type headers should not be changed and be followed. This is a way to opt out of MIME type sniffing, or, in other words, to say that the MIME types are deliberately configured.',
        'url': 'https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options',
    },
    'xFrameOptions': {
        'name': 'X-Frame-Options Header',
        'type': 'secure',
        'typeName': 'HTTP Header',
        'details': {
            'pass': 'X-Frame-Options header is set to',
            'warning': 'Set X-Frame-Options header to "DENY" or "SAMEORIGIN"',
        },
        'info': 'The X-Frame-Options header can be used to indicate whether or not a browser should be allowed to render a page in a <frame>, <iframe>, <embed> or <object>. Sites can use this to avoid click-jacking attacks, by ensuring that their content is not embedded into other sites.',
        'url': 'https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options',
    },
    'xXssProtection': {
        'name': 'X-XSS-Protection Header',
        'type': 'secure',
        'typeName': 'HTTP Header',
        'details': {
            'pass': 'X-XSS-Protection header is set to',
            'warning': 'Set X-XSS-Protection header to "1; mode=block"',
        },
        'info': 'The X-XSS-Protection header is a feature of Internet Explorer, Chrome and Safari that stops pages from loading when they detect reflected cross-site scripting (XSS) attacks. Although these protections are largely unnecessary in modern browsers when sites implement a strong Content Security Policy that disables the use of inline JavaScript, they can still provide protections for users of older web browsers that don’t yet support CSP.',
        'url': 'https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-XSS-Protection',
    },
    'craftFoldersAboveWebRoot': {
        'name': 'Craft Folders Above Web Root',
        'typeName': 'File/Folder System',
        'type': 'folder',
        'details': {
            'pass': 'Craft folders are located above the web root',
            'warning': 'Craft folders not located above the web root:',
        },
        'info': 'Keeping the Craft folders above the web root ensures that no one can access any of their files directly.',
        'url': 'https://craftcms.com/docs/3.x/installation.html#step-1-download-craft',
    },
    'craftFolderPermissions': {
        'name': 'Craft Folder Permissions',
        'typeName': 'File/Folder System',
        'type': 'folder',
        'details': {
            'pass': 'Craft folder permissions are correctly set',
            'warning': 'Craft folder permissions are not correctly set:',
        },
        'info': 'The folder permissions of Craft’s writeable folders. Set these to at most 0775, which will grant everything for the owner and group, read and execute for everyone else.',
        'url': 'https://craftcms.com/docs/3.x/installation.html#step-2-set-the-file-permissions',
    },
    'craftFilePermissions': {
        'name': 'Craft File Permissions',
        'typeName': 'File/Folder System',
        'type': 'files',
        'details': {
            'pass': 'Craft file permissions are correctly set',
            'warning': 'Craft file permissions are not correctly set:',
        },
        'info': 'The file permissions of Craft’s writable files. Set these to at most 0664, which will grant read and write for the owner and group, read for everyone else.',
        'url': 'https://craftcms.com/docs/3.x/installation.html#step-2-set-the-file-permissions',
    },
    'phpVersion': {
        'name': 'PHP Version',
        'type': 'code',
        'typeName': 'Server Language',
        'details': {
            'pass': 'Site is running on a supported PHP version',
            'warning': 'Site is running on an unsupported PHP version',
        },
        'info': 'Each release branch of PHP is fully supported for two years from its initial stable release, followed by an additional year for critical security issues only. After this time the branch reaches its end of life and is no longer supported.',
        'url': 'http://php.net/supported-versions.php',
    },
    'craftUpdates': {
        'name': 'Craft Updates',
        'type': 'upload',
        'typeName': 'Software Update',
        'details': {
            'pass': 'No Craft updates available',
            'warning': 'Your version of Craft is behind the latest version',
        },
        'info': 'Craft updates can contain security enhancements and bug fixes so it is recommended to keep it updated whenever possible.',
        'url': 'https://github.com/craftcms/cms/blob/master/CHANGELOG.md',
    },
    'pluginUpdates': {
        'name': 'Plugin Updates',
        'type': 'plugin',
        'typeName': 'Plugins',
        'details': {
            'pass': 'No plugin updates available',
            'warning': 'Update plugins to latest versions:',
        },
        'info': 'Plugin updates can contain security enhancements and bug fixes so it is recommended to keep them updated whenever possible.',
    },
    'requireEmailVerification': {
        'name': 'Require Email Verification',
        'type': 'user',
        'typeName': 'User Setting',
        'details': {
            'pass': 'Require email verification is enabled',
            'warning': 'Require email verification is disabled',
        },
        'info': 'Requiring that new email addresses are verified before getting saved to user accounts ensures that they are genuine and active email addresses.',
    },
    'devMode': {
        'name': 'Dev Mode',
        'type': 'settings',
        'typeName': 'Config Setting',
        'details': {
            'pass': 'Dev mode is disabled',
            'warning': 'Disable dev mode',
        },
        'info': 'Dev mode is intended for testing and debugging your site and outputs performance related data on the front-end. It should never be enabled in live production environments.',
        'url': 'https://craftcms.com/docs/3.x/config/config-settings.html#devmode',
    },
    'translationDebugOutput': {
        'name': 'Translation Debug Output',
        'type': 'settings',
        'typeName': 'Config Setting',
        'details': {
            'pass': 'Translation debug output is disabled',
            'warning': 'Set translation debug output to false',
        },
        'info': 'If enabled, this setting will wrap all strings that are run through `Craft::t()` or the `|translate` filter with "@" symbols. It is intended for debugging and should be disabled in live production environments.',
        'url': 'https://craftcms.com/docs/3.x/config/config-settings.html#translationdebugoutput',
    },
    'defaultFileMode': {
        'name': 'Default File Permissions',
        'type': 'settings',
        'typeName': 'Config Setting',
        'details': {
            'pass': 'Default file permissions are set to ',
            'warning': 'Set default file permissions to 0664 or null',
        },
        'info': 'The permissions Craft will use when creating a new file on the file system. Set this to at most 0664, which will grant read and write for the owner and group, read for everyone else. If set to null, the permission will be determined by the current environment.',
        'url': 'https://craftcms.com/docs/3.x/config/config-settings.html#defaultfilemode',
    },
    'defaultDirMode': {
        'name': 'Default Folder Permissions',
        'type': 'settings',
        'typeName': 'Config Setting',
        'details': {
            'pass': 'Default folder permissions are set to ',
            'warning': 'Set default folder permissions to 0775 or null',
        },
        'info': 'The permissions Craft will use when creating a new folder on the file system. Set this to at most 0775, which will grant everything for the owner and group, read and execute for everyone else. If set to null, the permission will be determined by the current environment.',
        'url': 'https://craftcms.com/docs/3.x/config/config-settings.html#defaultdirmode',
    },
    'defaultTokenDuration': {
        'name': 'Default Token Duration',
        'type': 'settings',
        'typeName': 'Config Setting',
        'details': {
            'pass': 'Default token duration is set to',
            'warning': 'Set default token duration to P1D (86400) or less',
        },
        'info': 'The duration that system tokens should last for. Setting this to P1D (86400) or less will ensure that system tokens expire after at most 1 day.',
        'url': 'https://craftcms.com/docs/3.x/config/config-settings.html#defaulttokenduration',
    },
    'enableCsrfProtection': {
        'name': 'CSRF Protection',
        'type': 'settings',
        'typeName': 'Config Setting',
        'details': {
            'pass': 'CSRF protection is enabled',
            'warning': 'Enable CSRF protection',
        },
        'info': 'Cross-Site Request Forgery (CSRF) protection ensures that all POST requests to Craft must be accompanied by a CSRF token, otherwise the request will be rejected with a 400 error. This helps to prevent attacks that force unwanted actions to be executed on behalf of a user that is authenticated and logged in to Craft.',
        'url': 'https://craftcms.com/docs/3.x/config/config-settings.html#enablecsrfprotection',
    },
    'useSecureCookies': {
        'name': 'Use Secure Cookies',
        'type': 'settings',
        'typeName': 'Config Setting',
        'details': {
            'pass': 'Site is using secure cookies',
            'warning': 'Set secure cookies to "on" or "auto"',
        },
        'info': 'Whether Craft should set the secure flag on its cookies, limiting them to only be sent on secure (SSL) requests. Setting this to "on" or "auto" will ensure that the secure flag is set.',
        'url': 'https://craftcms.com/docs/3.x/config/config-settings.html#usesecurecookies',
    },
    'cpTrigger': {
        'name': 'Control Panel Trigger',
        'type': 'settings',
        'typeName': 'Config Setting',
        'details': {
            'pass': 'Control panel trigger is not "admin"',
            'warning': 'Change control panel trigger to something other than "admin"',
        },
        'info': 'This is the URI segment that triggers Craft to load the control panel rather than the front-end website. Changing this to something other than the default "admin" can help prevent people from guessing the access point to your site’s control panel.',
        'url': 'https://craftcms.com/docs/3.x/config/config-settings.html#cptrigger',
    },
    'blowfishHashCost': {
        'name': 'Blowfish Hash Cost',
        'type': 'settings',
        'typeName': 'Config Setting',
        'details': {
            'pass': 'Blowfish hash cost is set to',
            'warning': 'Set blowfish hash cost to at least 13',
        },
        'info': 'The higher the cost value, the longer it takes to generate a password hash and to verify against it. For best protection against brute force attacks, set it to the highest value that is tolerable on your server.',
        'url': 'https://craftcms.com/docs/3.x/config/config-settings.html#blowfishhashcost',
    },
    'cooldownDuration': {
        'name': 'Cooldown Duration',
        'type': 'settings',
        'typeName': 'Config Setting',
        'details': {
            'pass': 'Cooldown duration is set to',
            'warning': 'Set cooldown duration to false or at least PT5M (300)',
        },
        'info': 'The amount of time a user must wait before re-attempting to log in after their account is locked due to too many failed login attempts. Setting this to false will keep the account locked indefinitely. Setting this to PT5M (300) will keep the account locked for 5 minutes.',
        'url': 'https://craftcms.com/docs/3.x/config/config-settings.html#cooldownduration',
    },
    'deferPublicRegistrationPassword': {
        'name': 'Defer Public Registration Password',
        'type': 'settings',
        'typeName': 'Config Setting',
        'details': {
            'pass': 'Defer public registration password is disabled',
            'warning': 'Defer public registration password to false',
        },
        'info': 'By default, Craft will require a password field to be submitted on front-end, public user registrations. Setting this to true will no longer require it on the initial registration form. If you have email verification enabled, new users will set their password once they’ve clicked on the verification link in the email. If you don’t, the only way they can set their password is to go through your forgot password workflow.',
        'url': 'https://craftcms.com/docs/3.x/config/config-settings.html#deferpublicregistrationpassword',
    },
    'elevatedSessionDuration': {
        'name': 'Elevated Session Duration',
        'type': 'settings',
        'typeName': 'Config Setting',
        'details': {
            'pass': 'Elevated session duration is set to',
            'warning': 'Set elevated session duration to PT5M (300) or less',
        },
        'info': 'The amount of time a user’s elevated session will last, which is required for some sensitive actions (e.g. user group/permission assignment). Setting this to PT5M (300) or less will allow sensitive actions to be performed for at most 5 minutes.',
        'url': 'https://craftcms.com/docs/3.x/config/config-settings.html#elevatedsessionduration',
    },
    'invalidLoginWindowDuration': {
        'name': 'Invalid Login Window Duration',
        'type': 'settings',
        'typeName': 'Config Setting',
        'details': {
            'pass': 'Invalid login window duration is set to',
            'warning': 'Set invalid login window duration to at least PT1H (3600)',
        },
        'info': 'The amount of time to track invalid login attempts for a user, for determining if Craft should lock an account. Setting this to at least PT1H (3600) will ensure that invalid login attempts are tracked for at least 1 hour.',
        'url': 'https://craftcms.com/docs/3.x/config/config-settings.html#invalidloginwindowduration',
    },
    'maxInvalidLogins': {
        'name': 'Max Invalid Logins',
        'type': 'settings',
        'typeName': 'Config Setting',
        'details': {
            'pass': 'Max invalid logins is set to',
            'warning': 'Set max invalid logins to 5 or less',
        },
        'info': 'The number of invalid login attempts Craft will allow within the specified duration before the account gets locked. Set this to 5 or less to help prevent a brute force attack.',
        'url': 'https://craftcms.com/docs/3.x/config/config-settings.html#maxinvalidlogins',
    },
    'preventUserEnumeration': {
        'name': 'Prevent User Enumeration',
        'type': 'settings',
        'typeName': 'Config Setting',
        'details': {
            'pass': 'Prevent user enumeration is enabled',
            'warning': 'Set prevent user enumeration to true',
        },
        'info': 'When true, Craft will always return a successful response in the forgot password flow, making it difficult to enumerate users. When set to false and you go through the forgot password flow from the control panel login page, you’ll get distinct messages indicating whether the username/email exists and whether an email was sent with further instructions. This can be helpful for the user attempting to log in but allow for username/email enumeration based on the response.',
        'url': 'https://craftcms.com/docs/3.x/config/config-settings.html#preventuserenumeration',
    },
    'rememberedUserSessionDuration': {
        'name': 'Remembered User Session Duration',
        'type': 'settings',
        'typeName': 'Config Setting',
        'details': {
            'pass': 'Remembered user session duration is set to',
            'warning': 'Set remembered user session duration to P2W (1209600) or less',
        },
        'info': 'The amount of time a user stays logged in if "Remember Me" is checked on the login page. Setting this to P2W (1209600) or less will ensure that users are remembered for at most 2 weeks.',
        'url': 'https://craftcms.com/docs/3.x/config/config-settings.html#rememberedusersessionduration',
    },
    'requireMatchingUserAgentForSession': {
        'name': 'Require Matching User Agent For Session',
        'type': 'settings',
        'typeName': 'Config Setting',
        'details': {
            'pass': 'Require matching user agent for session is enabled',
            'warning': 'Set require matching user agent for session to true',
        },
        'info': 'Whether Craft should require a matching user agent string when restoring a user session from a cookie. Keeping this enabled will prevent users switching to different browsers/devices while remaining logged in.',
        'url': 'https://craftcms.com/docs/3.x/config/config-settings.html#requirematchinguseragentforsession',
    },
    'requireUserAgentAndIpForSession': {
        'name': 'Require User Agent And IP For Session',
        'type': 'settings',
        'typeName': 'Config Setting',
        'details': {
            'pass': 'Require user agent and IP for session is enabled',
            'warning': 'Set require user agent and IP for session to true',
        },
        'info': 'Whether Craft should require the existence of a user agent string and IP address when creating a new user session. Keeping this enabled will help prevent user sessions being created for bots.',
        'url': 'https://craftcms.com/docs/3.x/config/config-settings.html#requireuseragentandipforsession',
    },
    'sanitizeSvgUploads': {
        'name': 'Sanitize SVG Uploads',
        'type': 'settings',
        'typeName': 'Config Setting',
        'details': {
            'pass': 'Sanitizing uploaded SVG files is enabled',
            'warning': 'Set sanitize SVG uploads to true',
        },
        'info': 'Whether Craft should sanitize uploaded SVG files and strip out potential malicious-looking content. This should definitely be enabled if you are accepting SVG uploads from untrusted sources.',
        'url': 'https://craftcms.com/docs/3.x/config/config-settings.html#sanitizesvguploads',
    },
    'testToEmailAddress': {
        'name': 'Test Email Address',
        'type': 'settings',
        'typeName': 'Config Setting',
        'details': {
            'pass': 'Test email address is disabled',
            'warning': 'Remove test email address',
        },
        'info': 'If set, all system emails will be sent to this email address. It is intended for testing and should be disabled in live production environments.',
        'url': 'https://craftcms.com/docs/3.x/config/config-settings.html#testtoemailaddress',
    },
    'userSessionDuration': {
        'name': 'User Session Duration',
        'type': 'settings',
        'typeName': 'Config Setting',
        'details': {
            'pass': 'User session duration is set to',
            'warning': 'Set user session duration to PT1H (3600) or less',
        },
        'info': 'The amount of time a user stays logged in. Setting this to false will allow users to stay logged in as long as their browser is open. Setting this to PT1H (3600) or less will allow users to stay logged in for at most 1 hour.',
        'url': 'https://craftcms.com/docs/3.x/config/config-settings.html#usersessionduration',
    },
    'verificationCodeDuration': {
        'name': 'Verification Code Duration',
        'type': 'settings',
        'typeName': 'Config Setting',
        'details': {
            'pass': 'Verification code duration is set to',
            'warning': 'Set verification code duration to P1D (86400) or less',
        },
        'info': 'The amount of time a user verification code can be used before expiring. Setting this to P1D (86400) or less will ensure that the user verification code expires after at most 1 day.',
        'url': 'https://craftcms.com/docs/3.x/config/config-settings.html#verificationcodeduration',
    },
} %}
